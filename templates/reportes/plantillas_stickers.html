{% extends 'base.html' %}
{% load static %}

{% block title %}Plantillas de Stickers ZPL - Sistema de Patrimonio{% endblock %}

{% block extra_css %}
<style>
    .plantillas-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .plantillas-header {
        background: linear-gradient(135deg, #6f42c1, #8e44ad);
        color: white;
        padding: 30px;
        border-radius: 10px;
        margin-bottom: 30px;
        text-align: center;
    }
    
    .plantillas-header h1 {
        margin: 0;
        font-size: 2.5rem;
        font-weight: 600;
    }
    
    .plantillas-header p {
        margin: 10px 0 0 0;
        opacity: 0.9;
        font-size: 1.1rem;
    }
    
    .plantilla-card {
        background: white;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        margin-bottom: 25px;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .plantilla-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    
    .plantilla-header {
        background: #f8f9fa;
        padding: 20px;
        border-bottom: 1px solid #dee2e6;
    }
    
    .plantilla-title {
        margin: 0;
        font-size: 1.3rem;
        font-weight: 600;
        color: #2c3e50;
    }
    
    .plantilla-description {
        margin: 5px 0 0 0;
        color: #6c757d;
    }
    
    .plantilla-body {
        padding: 20px;
    }
    
    .plantilla-preview {
        background: #f8f9fa;
        border: 2px dashed #dee2e6;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
    }
    
    .sticker-sample {
        border: 2px solid #333;
        background: white;
        padding: 10px;
        display: inline-block;
        font-family: 'Courier New', monospace;
        font-size: 10px;
        line-height: 1.2;
        margin: 10px;
    }
    
    .plantilla-specs {
        background: #e3f2fd;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
    }
    
    .spec-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
    }
    
    .spec-label {
        font-weight: 600;
        color: #1976d2;
    }
    
    .spec-value {
        color: #424242;
    }
    
    .plantilla-actions {
        display: flex;
        gap: 10px;
        justify-content: center;
    }
    
    .btn {
        padding: 10px 20px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }
    
    .btn-primary {
        background: linear-gradient(135deg, #6f42c1, #8e44ad);
        color: white;
    }
    
    .btn-success {
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
    }
    
    .btn-info {
        background: linear-gradient(135deg, #17a2b8, #20c997);
        color: white;
    }
    
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        text-decoration: none;
        color: white;
    }
    
    .categoria-section {
        margin-bottom: 40px;
    }
    
    .categoria-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #6f42c1;
    }
    
    @media (max-width: 768px) {
        .plantillas-container {
            padding: 10px;
        }
        
        .plantilla-actions {
            flex-direction: column;
        }
        
        .plantillas-header {
            padding: 20px;
        }
        
        .plantillas-header h1 {
            font-size: 2rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="plantillas-container">
    <!-- Header -->
    <div class="plantillas-header">
        <h1>üè∑Ô∏è Plantillas de Stickers ZPL</h1>
        <p>Plantillas predefinidas optimizadas para diferentes tipos de bienes y impresoras</p>
    </div>
    
    <!-- Plantillas para Impresoras Zebra -->
    <div class="categoria-section">
        <h2 class="categoria-title">üñ®Ô∏è Impresoras Zebra (ZD220, ZD410, ZD411)</h2>
        
        <div class="row">
            <!-- Plantilla Peque√±a -->
            <div class="col-md-6">
                <div class="plantilla-card">
                    <div class="plantilla-header">
                        <h3 class="plantilla-title">Ticket Peque√±o</h3>
                        <p class="plantilla-description">Ideal para ZD411 - Informaci√≥n esencial + QR</p>
                    </div>
                    <div class="plantilla-body">
                        <div class="plantilla-preview">
                            <div class="sticker-sample" style="width: 120px; height: 80px;">
                                <div style="display: flex; gap: 5px;">
                                    <div style="width: 25px; height: 25px; border: 1px solid #000; font-size: 6px; display: flex; align-items: center; justify-content: center;">QR</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: bold; font-size: 8px;">PAT-001</div>
                                        <div style="font-size: 6px;">ESCRITORIO</div>
                                        <div style="font-size: 6px;">ADM-001</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="plantilla-specs">
                            <div class="spec-item">
                                <span class="spec-label">Dimensiones:</span>
                                <span class="spec-value">50x30mm (400x240 dots)</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Impresora:</span>
                                <span class="spec-value">ZD411 (203 DPI)</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Campos:</span>
                                <span class="spec-value">C√≥digo, Denominaci√≥n, Oficina</span>
                            </div>
                        </div>
                        
                        <div class="plantilla-actions">
                            <a href="{% url 'reportes:configurador_zebra' %}?plantilla=ticket_peque√±o" class="btn btn-primary">
                                ‚öôÔ∏è Usar Plantilla
                            </a>
                            <a href="#" onclick="descargarPlantilla('peque√±a')" class="btn btn-info">
                                üìÑ Descargar ZPL
                            </a>
                            <a href="#" onclick="verVistaPrevia('peque√±a')" class="btn btn-outline-info">
                                üëÅÔ∏è Vista Previa
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Plantilla Mediana -->
            <div class="col-md-6">
                <div class="plantilla-card">
                    <div class="plantilla-header">
                        <h3 class="plantilla-title">Etiqueta Mediana</h3>
                        <p class="plantilla-description">Ideal para ZD220/ZD410 - Informaci√≥n completa</p>
                    </div>
                    <div class="plantilla-body">
                        <div class="plantilla-preview">
                            <div class="sticker-sample" style="width: 160px; height: 100px;">
                                <div style="display: flex; gap: 8px;">
                                    <div style="width: 35px; height: 35px; border: 1px solid #000; font-size: 7px; display: flex; align-items: center; justify-content: center;">QR</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: bold; font-size: 10px;">PAT-001-2024</div>
                                        <div style="font-size: 8px;">ELECTROEYACULADOR</div>
                                        <div style="font-size: 7px;">Oficina: DIR. REGIONAL</div>
                                        <div style="font-size: 7px;">Estado: BUENO</div>
                                        <div style="font-size: 6px;">MARCA MODELO</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="plantilla-specs">
                            <div class="spec-item">
                                <span class="spec-label">Dimensiones:</span>
                                <span class="spec-value">75x50mm (600x400 dots)</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Impresora:</span>
                                <span class="spec-value">ZD220, ZD410 (203 DPI)</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Campos:</span>
                                <span class="spec-value">C√≥digo, Denominaci√≥n, Oficina, Estado, Marca</span>
                            </div>
                        </div>
                        
                        <div class="plantilla-actions">
                            <a href="{% url 'reportes:configurador_zebra' %}?plantilla=etiqueta_mediana" class="btn btn-primary">
                                ‚öôÔ∏è Usar Plantilla
                            </a>
                            <a href="#" onclick="descargarPlantilla('mediana')" class="btn btn-info">
                                üìÑ Descargar ZPL
                            </a>
                            <a href="#" onclick="verVistaPrevia('mediana')" class="btn btn-outline-info">
                                üëÅÔ∏è Vista Previa
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <!-- Plantilla Grande -->
            <div class="col-md-6">
                <div class="plantilla-card">
                    <div class="plantilla-header">
                        <h3 class="plantilla-title">Etiqueta Grande</h3>
                        <p class="plantilla-description">M√°xima informaci√≥n - Ideal para bienes complejos</p>
                    </div>
                    <div class="plantilla-body">
                        <div class="plantilla-preview">
                            <div class="sticker-sample" style="width: 200px; height: 120px;">
                                <div style="display: flex; gap: 10px;">
                                    <div style="width: 45px; height: 45px; border: 1px solid #000; font-size: 8px; display: flex; align-items: center; justify-content: center;">QR</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: bold; font-size: 12px;">PAT-001-2024</div>
                                        <div style="font-size: 9px;">ELECTROEYACULADOR PARA BOVINOS</div>
                                        <div style="font-size: 8px;">Oficina: DIRECCI√ìN REGIONAL</div>
                                        <div style="font-size: 8px;">Estado: BUENO</div>
                                        <div style="font-size: 7px;">MARCA EJEMPLO - MODELO XYZ</div>
                                        <div style="font-size: 7px;">Serie: SN123456789</div>
                                        <div style="font-size: 6px;">Fecha: 04/11/2025</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="plantilla-specs">
                            <div class="spec-item">
                                <span class="spec-label">Dimensiones:</span>
                                <span class="spec-value">100x75mm (800x600 dots)</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Impresora:</span>
                                <span class="spec-value">ZD220, ZD410 (203 DPI)</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Campos:</span>
                                <span class="spec-value">Todos los campos disponibles</span>
                            </div>
                        </div>
                        
                        <div class="plantilla-actions">
                            <a href="{% url 'reportes:configurador_zebra' %}?plantilla=etiqueta_grande" class="btn btn-primary">
                                ‚öôÔ∏è Usar Plantilla
                            </a>
                            <a href="#" onclick="descargarPlantilla('grande')" class="btn btn-info">
                                üìÑ Descargar ZPL
                            </a>
                            <a href="#" onclick="verVistaPrevia('grande')" class="btn btn-outline-info">
                                üëÅÔ∏è Vista Previa
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Plantilla Veh√≠culos -->
            <div class="col-md-6">
                <div class="plantilla-card">
                    <div class="plantilla-header">
                        <h3 class="plantilla-title">Especial Veh√≠culos</h3>
                        <p class="plantilla-description">Optimizada para veh√≠culos con placa y matr√≠cula</p>
                    </div>
                    <div class="plantilla-body">
                        <div class="plantilla-preview">
                            <div class="sticker-sample" style="width: 180px; height: 110px;">
                                <div style="display: flex; gap: 8px;">
                                    <div style="width: 40px; height: 40px; border: 1px solid #000; font-size: 7px; display: flex; align-items: center; justify-content: center;">QR</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: bold; font-size: 11px;">VEH-001-2024</div>
                                        <div style="font-size: 9px;">CAMIONETA TOYOTA</div>
                                        <div style="font-size: 8px; color: #d63384; font-weight: bold;">Placa: ABC-123</div>
                                        <div style="font-size: 8px;">Matr√≠cula: MAT-456</div>
                                        <div style="font-size: 7px;">Motor: MOT789012</div>
                                        <div style="font-size: 7px;">Chasis: CHA345678</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="plantilla-specs">
                            <div class="spec-item">
                                <span class="spec-label">Dimensiones:</span>
                                <span class="spec-value">85x60mm (680x480 dots)</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Impresora:</span>
                                <span class="spec-value">ZD220, ZD410 (203 DPI)</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Campos:</span>
                                <span class="spec-value">C√≥digo, Denominaci√≥n, Placa, Matr√≠cula, Motor, Chasis</span>
                            </div>
                        </div>
                        
                        <div class="plantilla-actions">
                            <a href="{% url 'reportes:configurador_zebra' %}?plantilla=vehiculos" class="btn btn-primary">
                                ‚öôÔ∏è Usar Plantilla
                            </a>
                            <a href="#" onclick="descargarPlantilla('vehiculos')" class="btn btn-info">
                                üìÑ Descargar ZPL
                            </a>
                            <a href="#" onclick="verVistaPrevia('vehiculos')" class="btn btn-outline-info">
                                üëÅÔ∏è Vista Previa
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Plantillas Cl√°sicas ZPL -->
    <div class="categoria-section">
        <h2 class="categoria-title">üè∑Ô∏è Plantillas Cl√°sicas ZPL</h2>
        
        <div class="row">
            <div class="col-md-12">
                <div class="plantilla-card">
                    <div class="plantilla-header">
                        <h3 class="plantilla-title">Configurador Cl√°sico</h3>
                        <p class="plantilla-description">Configurador tradicional con opciones avanzadas de personalizaci√≥n</p>
                    </div>
                    <div class="plantilla-body">
                        <div class="plantilla-specs">
                            <div class="spec-item">
                                <span class="spec-label">Caracter√≠sticas:</span>
                                <span class="spec-value">Tama√±os personalizables, m√∫ltiples posiciones QR, campos configurables</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Compatibilidad:</span>
                                <span class="spec-value">Todas las impresoras ZPL compatibles</span>
                            </div>
                        </div>
                        
                        <div class="plantilla-actions">
                            <a href="{% url 'reportes:configurar_stickers' %}" class="btn btn-success">
                                üõ†Ô∏è Abrir Configurador Cl√°sico
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Acciones Adicionales -->
    <div class="text-center" style="margin-top: 40px;">
        <a href="{% url 'reportes:menu_impresion_qr' %}" class="btn btn-info btn-lg">
            üîô Volver al Men√∫ Principal
        </a>
        <a href="{% url 'reportes:dashboard_reportes' %}" class="btn btn-primary btn-lg">
            üìä Dashboard de Reportes
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function descargarPlantilla(tipo) {
    // Generar c√≥digo ZPL b√°sico seg√∫n el tipo
    let zplCode = '';
    
    switch(tipo) {
        case 'peque√±a':
            zplCode = `^XA
^LH0,0
^PR4
^FO20,20^AN,20,20^FDPAT-001-2024^FS
^FO20,45^AN,15,15^FDESCRITORIO DE OFICINA^FS
^FO20,65^AN,12,12^FDOficina: ADM-001^FS
^FO300,20^BQN,2,4^FDQA,https://ejemplo.com/qr/123^FS
^XZ`;
            break;
        case 'mediana':
            zplCode = `^XA
^LH0,0
^PR4
^FO20,20^AN,25,25^FDPAT-001-2024^FS
^FO20,50^AN,18,18^FDELECTROEYACULADOR BOVINOS^FS
^FO20,75^AN,15,15^FDOficina: DIRECCION REGIONAL^FS
^FO20,95^AN,15,15^FDEstado: BUENO^FS
^FO20,115^AN,12,12^FDMARCA MODELO EJEMPLO^FS
^FO450,20^BQN,2,6^FDQA,https://ejemplo.com/qr/123^FS
^XZ`;
            break;
        case 'grande':
            zplCode = `^XA
^LH0,0
^PR4
^FO20,20^AN,30,30^FDPAT-001-2024^FS
^FO20,55^AN,20,20^FDELECTROEYACULADOR PARA BOVINOS^FS
^FO20,80^AN,18,18^FDOficina: DIRECCION REGIONAL^FS
^FO20,105^AN,18,18^FDEstado: BUENO^FS
^FO20,130^AN,15,15^FDMARCA EJEMPLO - MODELO XYZ^FS
^FO20,150^AN,15,15^FDSerie: SN123456789^FS
^FO20,170^AN,12,12^FDFecha: ${new Date().toLocaleDateString()}^FS
^FO600,20^BQN,2,8^FDQA,https://ejemplo.com/qr/123^FS
^XZ`;
            break;
        case 'vehiculos':
            zplCode = `^XA
^LH0,0
^PR4
^FO20,20^AN,25,25^FDVEH-001-2024^FS
^FO20,50^AN,18,18^FDCAMIONETA TOYOTA^FS
^FO20,75^AN,15,15^FDPlaca: ABC-123^FS
^FO20,95^AN,15,15^FDMatricula: MAT-456^FS
^FO20,115^AN,12,12^FDMotor: MOT789012^FS
^FO20,135^AN,12,12^FDChasis: CHA345678^FS
^FO500,20^BQN,2,6^FDQA,https://ejemplo.com/qr/123^FS
^XZ`;
            break;
    }
    
    // Crear y descargar archivo
    const blob = new Blob([zplCode], { type: 'text/plain' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `plantilla_${tipo}_${new Date().toISOString().slice(0,10)}.zpl`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
    
    // Mostrar mensaje
    alert(`Plantilla ${tipo} descargada como archivo ZPL`);
}

function verVistaPrevia(tipo) {
    // Datos de ejemplo seg√∫n el tipo
    let datos = {};
    let dimensiones = {};
    
    switch(tipo) {
        case 'peque√±a':
            datos = {
                codigo: 'PAT-001-2024',
                denominacion: 'ESCRITORIO DE OFICINA',
                oficina: 'ADM-001',
                estado: 'BUENO'
            };
            dimensiones = { ancho: '300px', alto: '200px' };
            break;
        case 'mediana':
            datos = {
                codigo: 'PAT-001-2024',
                denominacion: 'ELECTROEYACULADOR BOVINOS',
                oficina: 'DIRECCION REGIONAL',
                estado: 'BUENO',
                marca: 'MARCA MODELO EJEMPLO'
            };
            dimensiones = { ancho: '400px', alto: '250px' };
            break;
        case 'grande':
            datos = {
                codigo: 'PAT-001-2024',
                denominacion: 'ELECTROEYACULADOR PARA BOVINOS',
                oficina: 'DIRECCION REGIONAL',
                estado: 'BUENO',
                marca: 'MARCA EJEMPLO - MODELO XYZ',
                serie: 'SN123456789'
            };
            dimensiones = { ancho: '500px', alto: '300px' };
            break;
        case 'vehiculos':
            datos = {
                codigo: 'VEH-001-2024',
                denominacion: 'CAMIONETA TOYOTA',
                placa: 'ABC-123',
                matricula: 'MAT-456',
                motor: 'MOT789012',
                chasis: 'CHA345678'
            };
            dimensiones = { ancho: '450px', alto: '280px' };
            break;
    }
    
    // Crear ventana de vista previa minimalista
    const ventana = window.open('', '_blank', 'width=600,height=400');
    ventana.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
            <title>Plantilla ${tipo.charAt(0).toUpperCase() + tipo.slice(1)}</title>
            <style>
                body { 
                    font-family: Arial, sans-serif; 
                    margin: 0; 
                    padding: 20px; 
                    background: #f0f0f0; 
                    display: flex; 
                    justify-content: center; 
                    align-items: center; 
                    min-height: 100vh; 
                }
                .etiqueta { 
                    border: 3px solid #333; 
                    background: white; 
                    padding: 20px; 
                    font-family: 'Courier New', monospace; 
                    width: ${dimensiones.ancho}; 
                    height: ${dimensiones.alto}; 
                    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                    position: relative;
                }
                .qr-code { 
                    width: 60px; 
                    height: 60px; 
                    border: 2px solid #000; 
                    display: flex; 
                    align-items: center; 
                    justify-content: center; 
                    float: left; 
                    margin-right: 15px; 
                    background: repeating-linear-gradient(45deg, #000, #000 2px, #fff 2px, #fff 4px); 
                    color: white; 
                    font-weight: bold; 
                    font-size: 12px;
                }
                .info { 
                    margin-left: 80px; 
                    padding-top: 2px;
                }
                .codigo { 
                    font-size: ${tipo === 'peque√±a' ? '16px' : tipo === 'grande' ? '20px' : '18px'}; 
                    font-weight: bold; 
                    margin-bottom: 6px; 
                }
                .denominacion { 
                    font-size: ${tipo === 'peque√±a' ? '11px' : tipo === 'grande' ? '14px' : '12px'}; 
                    margin-bottom: 4px; 
                    line-height: 1.2;
                }
                .detalle { 
                    font-size: ${tipo === 'peque√±a' ? '9px' : tipo === 'grande' ? '11px' : '10px'}; 
                    margin-bottom: 2px; 
                    color: #555; 
                }
            </style>
        </head>
        <body>
            <div class="etiqueta">
                <div class="qr-code">QR</div>
                <div class="info">
                    <div class="codigo">${datos.codigo}</div>
                    <div class="denominacion">${datos.denominacion}</div>
                    ${datos.oficina ? `<div class="detalle">Oficina: ${datos.oficina}</div>` : ''}
                    ${datos.estado ? `<div class="detalle">Estado: ${datos.estado}</div>` : ''}
                    ${datos.marca ? `<div class="detalle">${datos.marca}</div>` : ''}
                    ${datos.serie ? `<div class="detalle">Serie: ${datos.serie}</div>` : ''}
                    ${datos.placa ? `<div class="detalle">Placa: ${datos.placa}</div>` : ''}
                    ${datos.matricula ? `<div class="detalle">Matr√≠cula: ${datos.matricula}</div>` : ''}
                    ${datos.motor ? `<div class="detalle">Motor: ${datos.motor}</div>` : ''}
                    ${datos.chasis ? `<div class="detalle">Chasis: ${datos.chasis}</div>` : ''}
                </div>
                <div style="clear: both;"></div>
            </div>
        </body>
        </html>
    `);
}
</script>
{% endblock %}